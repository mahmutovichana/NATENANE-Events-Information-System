<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Natenane </title>
    <!-- favicon -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <!-- bootstrap -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- fontawesome icon  -->
    <link rel="stylesheet" href="assets/css/fontawesome.min.css">
    <!-- flaticon css -->
    <link rel="stylesheet" href="assets/fonts/flaticon.css">
    <!-- animate.css -->
    <link rel="stylesheet" href="assets/css/animate.css">
    <!-- Owl Carousel -->
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <!-- magnific popup -->
    <link rel="stylesheet" href="assets/css/magnific-popup.css">
    <!-- stylesheet -->
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- responsive -->
    <link rel="stylesheet" href="assets/css/responsive.css">
</head>

<body>

    <!-- preloader begin -->
    <div class="preloader">
        <div class="loader">
            <hr>
            <hr>
        </div>
    </div>
    <!-- preloader end -->

    <script>
        async function loginUser(username, password) {
            try {
                const response = await fetch('/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password }),
                });

                const result = await response.json();

                if (result.success) {
                    document.getElementById('greeting').innerText = 'Zdravo, ' + result.userData.name;
                    sessionStorage.setItem('loggedInUser', JSON.stringify(result.userData));
                    sessionStorage.setItem('loggedInUsername', username);
                    window.location.href = 'index.html';
                } else {
                    alert('Pogrešno korisničko ime ili lozinka');
                }
            } catch (error) {
                console.error('Greška prilikom prijave:', error);
            }
        }

        async function registerUser(firstName, lastName, email, username, password, bankAccount) {
    try {
        const response = await fetch('/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ firstName, lastName, email, username, password, bankAccount }),
        });

        const result = await response.json();

        if (result.success) {
            alert('Registracija uspješna. Prijavite se.');
        } else {
            alert('Registracija nije uspjela');
        }
    } catch (error) {
        console.error('Greška prilikom registracije:', error);
    }
}

        document.addEventListener('DOMContentLoaded', function () {
            const loggedInUsername = sessionStorage.getItem('loggedInUsername');
            const loginLink = document.getElementById('loginLink');
            const logoutLink = document.getElementById('logoutLink');
            const profileLink = document.getElementById('profileLink');
    
            if (loggedInUsername) {
                document.getElementById('greeting').innerText = 'Zdravo, ' + loggedInUsername;
                loginLink.style.display = 'none';
                logoutLink.style.display = 'block';
                profileLink.style.display = 'block';
            } else {
                loginLink.style.display = 'block';
                logoutLink.style.display = 'none';
                profileLink.style.display = 'none';
            }
        });
    </script>

   <!-- header begin -->
<div class="header">
    <div class="container">
        <div class="row" style="justify-content: flex-end;">
            <div class="col-xl-4 col-lg-4 d-xl-flex d-lg-flex align-items-center">
                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-6 d-xl-block d-lg-block d-flex align-items-center">
                        <div class="logo">
                            <a href="index.html"><img src="assets/img/logo.png" alt=""></a>
                        </div>
                    </div>
                    <div class="d-xl-none d-lg-none d-block col-6">
                        <button class="navbar-toggler" type="button" data-toggle="collapse"
                            data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                            aria-expanded="false" aria-label="Toggle navigation">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-xl-8 col-lg-8">
                <div class="mainmenu">
                    <nav class="navbar navbar-expand-lg">
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav mr-auto">
                                <li class="nav-item">
                                    <a class="nav-link" href="index.html">Početna</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="about.html">O nama</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="gallery.html">Galerija</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="schedule.html">Događaji</a>
                                </li>
                                <li class="nav-item" id="loginLink">
                                    <a class="nav-link active" href="login.html">Prijava</a>
                                </li>
                                <li class="nav-item" id="logoutLink" style="display: none;">
                                    <a class="nav-link active" href="login.html">Odjava</a>
                                </li>
                                <li class="nav-item" id="profileLink" style="display: none;">
                                    <a class="nav-link" href="myProfile.html">Profil</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="faq.html">Pomoć</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="contact.html">Kontakt</a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
            <p id="greeting" style="margin: 0; color: #fff; font-family: Poppins; text-align: right;"><strong></strong></p>
        </div>
    </div>
</div>
<!-- header end -->

<!-- breadcrump begin -->
<div class="breadcrump">
    <div class="container">
        <div class="row">
            <div class="col-xl-6 col-lg-6">
                <div class="breadcrump-content">
                    <span class="page-name">Naslovna</span>
                    <span class="icon"><i class="fas fa-chevron-right"></i></span>
                    <span class="page-name">Prijava</span>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- breadcrump end -->

<!-- Dodajte gumb za odjavu ispod forme za prijavu -->
<button onclick="logoutUser()" id="logoutButton">Odjava</button>

<style>

    #logoutButton {
        display: none;
        margin: 0 auto; 
        padding: 10px 20px; 
        background-image: -webkit-linear-gradient(0deg, #ff6975 0%, #d34d94 56%, #a730b2 100%);
        color: #fff; 
        border: none; 
        cursor: pointer; 
        border-radius: 5px; 
    }
</style>

<script>
    // Dodajte funkciju za odjavu
    function logoutUser() {
        sessionStorage.removeItem('loggedInUser');
        sessionStorage.removeItem('loggedInUsername');
        window.location.href = 'index.html';
    }

    document.addEventListener('DOMContentLoaded', function () {
        const loggedInUsername = sessionStorage.getItem('loggedInUsername');
        const loginForm = document.querySelector('.comment-box:first-of-type');
        const registerForm = document.querySelector('.comment-box:last-of-type');
        const logoutButton = document.getElementById('logoutButton');

        if (loggedInUsername) {
            // Korisnik je prijavljen
            document.getElementById('greeting').innerText = 'Zdravo, ' + loggedInUsername;
            loginForm.style.display = 'none'; // Sakrij formu za prijavu
            registerForm.style.display = 'none'; // Sakrij formu za registraciju
            logoutButton.style.display = 'block'; // Prikazi gumb za odjavu
        } else {
            // Korisnik nije prijavljen
            loginForm.style.display = 'block'; // Prikazi formu za prijavu
            registerForm.style.display = 'block'; // Prikazi formu za registraciju
            logoutButton.style.display = 'none'; // Sakrij gumb za odjavu
        }
    });
</script>



<!-- blog details begin -->
<div class="blog blog-details">
    <div class="container">
        <div class="row">
            <div class="col-xl-8 col-lg-8">
                <div class="comment-box" style="margin-top: -120px;">
                    <h3>Imate račun? Prijavite se</h3>
                    <form action="/login" method="POST" onsubmit="event.preventDefault(); loginUser(document.getElementById('username').value, document.getElementById('password').value);">
                        <div class="row">
                            <div class="col-xl-6 col-lg-6">
                                <input type="text" placeholder="Korisničko ime" id="username">
                                <span></span>
                            </div>
                            <div class="col-xl-6 col-lg-6">
                                <input type="password" placeholder="Lozinka" id="password">
                                <span></span>
                            </div>
                            <div class="col-xl-12 col-lg-12">
                                <button type="submit">Prijava</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="comment-box" style="margin-top: 50px;">
                    <h3>Niste član? Registrujte se i uživajte u ekskluzivnim pogodnostima!</h3>
                    <form action="/register" method="POST" onsubmit="event.preventDefault(); registerUser(document.getElementById('first_name').value, document.getElementById('last_name').value, document.getElementById('email').value, document.getElementById('new_username').value, document.getElementById('new_password').value, document.getElementById('bank_account').value);">
                        <div class="row">
                            <div class="col-xl-6 col-lg-6">
                                <input type="text" placeholder="Ime" id="first_name">
                                <span></span>
                            </div>
                            <div class="col-xl-6 col-lg-6">
                                <input type="text" placeholder="Prezime" id="last_name">
                                <span></span>
                            </div>
                            <div class="col-xl-6 col-lg-6">
                                <input type="text" placeholder="E-mail" id="email">
                                <span></span>
                            </div>
                            <div class="col-xl-6 col-lg-6">
                                <input type="text" placeholder="Korisničko ime" id="new_username">
                                <span></span>
                            </div>
                            <div class="col-xl-6 col-lg-6">
                                <input type="password" placeholder="Lozinka" id="new_password">
                                <span></span>
                            </div>
                            <div class="col-xl-6 col-lg-6">
                                <input type="text" placeholder="Bankovni račun" id="bank_account">
                                <span></span>
                            </div>
                            <div class="col-xl-12 col-lg-12">
                                <button type="submit">Registracija</button>
                            </div>
                        </div>
                    </form>
                </div>
                
            </div>
        </div>
    </div>
</div>
<!-- blog details end -->

    <!-- footer begin -->
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xl-5 col-lg-4 d-xl-flex d-lg-flex align-items-center">
                    <div class="logo">
                        <a href="index.html"><img src="assets/img/logo.png" alt=""></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- footer end -->

    <!-- jquery -->
    <script src="assets/js/jquery.js"></script>
    <!-- bootstrap -->
    <script src="assets/js/bootstrap.min.js"></script>
    <!-- owl carousel -->
    <script src="assets/js/owl.carousel.js"></script>
    <!-- magnific popup -->
    <script src="assets/js/jquery.magnific-popup.js"></script>
    <!-- way poin js-->
    <script src="assets/js/waypoints.min.js"></script>
    <!-- wow js-->
    <script src="assets/js/wow.min.js"></script>
    <!-- main -->
    <script src="assets/js/main.js"></script>
</body>

</html>